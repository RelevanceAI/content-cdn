<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Replicate CDN Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
        }
        .section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .media-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        .media-card img, .media-card video {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: #f0f0f0;
        }
        .media-card .info {
            padding: 10px;
        }
        .media-card .label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }
        .media-card .url {
            font-size: 11px;
            color: #999;
            word-break: break-all;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        img.error, video.error {
            border: 2px solid #dc3545;
        }
    </style>
</head>
<body>
    <h1>üß™ Replicate CDN Media Test</h1>
    <p>Testing media files from local CDN server. All images and videos should load correctly.</p>

    <div class="section">
        <h2>üì¶ Collection Covers <span class="status success" id="collection-status">Loading...</span></h2>
        <div class="grid" id="collections"></div>
    </div>

    <div class="section">
        <h2>üé¨ Sample Model Media <span class="status success" id="models-status">Loading...</span></h2>
        <div class="grid" id="models"></div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:8080';

        // Collection covers
        const collections = [
            { name: 'Text to Video', file: 'text-to-video.mp4', type: 'video' },
            { name: 'Text to Image', file: 'text-to-image.webp', type: 'image' },
            { name: 'Text to Speech', file: 'text-to-speech.webp', type: 'image' },
            { name: 'AI Music', file: 'ai-music-generation.webp', type: 'image' },
            { name: 'Remove Backgrounds', file: 'remove-backgrounds.webp', type: 'image' },
            { name: 'Speech to Text', file: 'speech-to-text.webp', type: 'image' },
            { name: 'Lipsync', file: 'lipsync.mp4', type: 'video' },
            { name: 'Video to Text', file: 'video-to-text.mp4', type: 'video' },
        ];

        // Sample models
        const models = [
            { name: 'Google Veo-3', path: 'google__veo-3/cover.webp', type: 'image' },
            { name: 'Minimax Hailuo', path: 'minimax__hailuo-2.3/cover.mp4', type: 'video' },
            { name: 'Meta SAM-2', path: 'meta__sam-2-video/cover.webp', type: 'image' },
            { name: 'Flux Music', path: 'zsxkib__flux-music/cover.webp', type: 'image' },
            { name: 'ByteDance SeeDANCE', path: 'bytedance__seedance-1-pro-fast/cover.mp4', type: 'video' },
            { name: 'Google Imagen 4', path: 'google__imagen-4-fast/cover.webp', type: 'image' },
        ];

        let loadedCount = 0;
        let errorCount = 0;
        const totalMedia = collections.length + models.length;

        function updateStatus() {
            const percentage = Math.round((loadedCount / totalMedia) * 100);
            document.getElementById('collection-status').textContent =
                `${loadedCount}/${collections.length} loaded`;
            document.getElementById('models-status').textContent =
                `${loadedCount - collections.length}/${models.length} loaded`;

            if (errorCount > 0) {
                document.getElementById('collection-status').className = 'status error';
                document.getElementById('models-status').className = 'status error';
            }
        }

        function createMediaCard(name, url, type) {
            const card = document.createElement('div');
            card.className = 'media-card';

            const media = type === 'video' ? document.createElement('video') : document.createElement('img');
            media.src = url;
            if (type === 'video') {
                media.controls = true;
                media.muted = true;
            }

            media.onload = media.onloadeddata = () => {
                loadedCount++;
                updateStatus();
            };

            media.onerror = () => {
                media.className = 'error';
                errorCount++;
                loadedCount++;
                updateStatus();
            };

            const info = document.createElement('div');
            info.className = 'info';
            info.innerHTML = `
                <div class="label">${name}</div>
                <div class="url">${url}</div>
            `;

            card.appendChild(media);
            card.appendChild(info);
            return card;
        }

        // Load collections
        const collectionsGrid = document.getElementById('collections');
        collections.forEach(col => {
            const url = `${BASE_URL}/replicate/collections/${col.file}`;
            const card = createMediaCard(col.name, url, col.type);
            collectionsGrid.appendChild(card);
        });

        // Load models
        const modelsGrid = document.getElementById('models');
        models.forEach(model => {
            const url = `${BASE_URL}/replicate/models/${model.path}`;
            const card = createMediaCard(model.name, url, model.type);
            modelsGrid.appendChild(card);
        });

        // Check if server is running
        fetch(`${BASE_URL}/replicate/collections/text-to-image.webp`)
            .then(response => {
                if (!response.ok) {
                    alert('‚ö†Ô∏è CDN server might not be running. Start it with: bash test-cdn-locally.sh');
                }
            })
            .catch(() => {
                alert('‚ö†Ô∏è CDN server is not running!\n\nStart it with:\ncd /Users/michael.shaimerden/Documents/GitHub/content-cdn\nbash test-cdn-locally.sh');
            });
    </script>
</body>
</html>
